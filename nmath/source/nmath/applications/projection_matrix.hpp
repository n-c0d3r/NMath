#pragma once

/** @file nmath/applications/projection_matrix.hpp
*
*   Implement projection matrix.
*/



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



#pragma region Includes

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include <nmath/prerequisites.hpp>

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include <nmath/types/matrix.hpp>

#pragma endregion



namespace nmath {

    ////////////////////////////////////////////////////////////////////////////////////
    //  f32
    ////////////////////////////////////////////////////////////////////////////////////
    NCPP_FORCE_INLINE F_matrix4x4_f32 perspective_projection_matrix(f32 verticle_fov, f32 aspect_ratio, f32 near_plane, f32 far_plane) noexcept {

        float ys = 2.0f * near_plane / tanf(verticle_fov * 0.5);
        float xs = ys / aspect_ratio;
        float zs = far_plane / (far_plane - near_plane);

        return {
            F_vector4_f32 {xs, 0, 0, 0},
            F_vector4_f32 {0, ys, 0, 0},
            F_vector4_f32 {0, 0, zs, 1},
            F_vector4_f32 {0, 0, -zs * near_plane, 0}
        };
    }
    NCPP_FORCE_INLINE F_matrix4x4_f32 orthographic_projection_matrix(PA_vector2_f32 view_size, f32 near_plane, f32 far_plane) noexcept {

        float range = 1.0f / (far_plane - near_plane);

        return {
            F_vector4_f32 {2.0f / view_size.width, 0, 0, 0},
            F_vector4_f32 {0, 2.0f / view_size.height, 0, 0},
            F_vector4_f32 {0, 0, range, 1.0f},
            F_vector4_f32 {0, 0, -range * near_plane, 1.0f}
        };
    }

}